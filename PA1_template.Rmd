Analysis of Activity Monitoring data
========================================================
# Introduction

It is now possible to collect a large amount of data about personal movement using activity monitoring
devices such as a Fitbit, Nike Fuelband, or Jawbone Up. These type of devices are part of the "quantified
self" movement - a group of enthusiasts who take measurements about themselves regularly to improve
their health, to find patterns in their behavior, or because they are tech geeks. 
## Data
We analyzed data generated by an activity monitoring device. The dataset has three variables (i) the number of steps taken in a 5minute interval, (ii) the date when the measurements were taken and (iii) an interval identifier for the 5 minute interval in which the measurements where taken.
## Loading and Preprocessing the data

```{r loading data, echo=TRUE}
#Unzip the downloaded data
unzip("repdata-data-activity.zip")
# Read the data into r
activity = read.csv("activity.csv", header=TRUE)
#Format date
activity$date <- as.POSIXct(paste(activity$date), format="%Y-%m-%d")
head(activity)
# subset the data and remove NAs
activity1 = na.omit(activity)
head(activity1)
```

## Histogram of the number of steps taken each day

```{r fig.width=7, fig.height=6}
#Calculating the total number of steps taken each day
total_steps= tapply(activity$steps, activity$date, sum)
#Histogram number of steps per day

hist(total_steps, breaks=10, main= "Total Number of Steps taken each Day", xlab="Total Steps")
```
## The Mean and Median Total number of steps taken per day
```{r mean and median, echo=TRUE}
# Calculate mean number of steps taken per day
means= tapply(activity1$steps, activity1$date, mean)
#Calculates median number of steps taken per day
median= tapply(activity1$steps, activity1$date, median)
#Gives a summary of mean and median number of steps taken per day
steps_mean_median= cbind(means, median)
steps_mean_median
```
## Average daily activity pattern
A time series plot of the 5-minute interval on the x-axis and the average number of steps averaged across all days.
```{r Time series plot, echo=TRUE}
#Calculate the average number of steps per each interval for across all days
time_interval = tapply(activity1$steps, activity1$interval, mean)
#Plots average number of says for across all days against each time interval
plot(time_interval, type="l", main="Time series plot of 5-minute interval and the average number of steps across all days", xlab="Interval", ylab="Average number of steps")
```

### Maximum average number of steps = 206.1698, corresponding to time interval 835

# Imputing missing values
## Calculating the total number of missing values in the dataset
```{r Missing values, echo=TRUE}
nrow(activity[!complete.cases(activity),])
```
### Creating new data frame with NAs replaced by the average total number of steps.
```{r, Replace NAs, echo=TRUE}
#New data frame
activity2=activity
#Replace na in original data (activity) steps variable with mean of steps for all dates
activity2$steps[is.na(activity2$steps)] = mean_steps
head(activity2)
```
```{r, Weekdays and Weekends, echo=TRUE}
# Subsetting the dates into weekdays and weekends
week_d <- activity2$date
week_d <- strptime(week_d, "%Y-%m-%d")
week_d <- weekdays(week_d)
week_d <- as.character(week_d)

for (i in 1:length(week_d)){
    if(week_d[i]=="Saturday" | week_d[i]=="Sunday") {
        week_d[i] <- "weekend"
    } else {
        week_d[i] <- "weekday"
    }
}
#Create weekdays and weekends as factor variables
week_d <- factor(week_d)
#adding new column of week day
library(dplyr)
activity2 = mutate(activity2, week_d)
```

### Plotting a time series of the 5 minute interval and average number of steps taken averaged across weekdays and weekends
```{r, Time series graph, echo=TRUE}
library(lattice)
xyplot(steps ~ interval |week_d, data= activity2, layout=c(1,2), type="l", ylab= "Number of steps", xlab= "Interval")
```







